<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result page</title>
</head>
<body>
    <div id="content"></div>
    <script>
        function getUrlParameters() {
            // Get the query string from the URL
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);

            // Extract 'content' parameter and decode it
            const base64Content = urlParams.get('content');
            const contentElement = document.getElementById('content')
            if (base64Content) {
                contentElement.innerHTML = base64DecodeUtf8(base64Content);
            } else {
                const exampleUrl = `${window.location.origin}${window.location.pathname}?title=Custom%20title&content=Q3VzdG9tIDxiPmNvbnRlbnQ8L2I+`;
                contentElement.innerHTML = 'No content provided. <a href="' + exampleUrl + '">Click here for an example.</a>';
            }

            // Extract 'title' parameter and set it as the page title
            const pageTitle = urlParams.get('title');
            if (pageTitle) {
                document.title = decodeURIComponent(pageTitle);
            }
        }

        // Decode Base64 to a string correctly handling UTF-8 content
        function base64DecodeUtf8(str) {
            // Decode base64 to a byte array
            const binaryString = window.atob(str);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            // Convert byte array to a UTF-8 string
            return new TextDecoder().decode(bytes);
        }

        // Call the function when the page loads
        window.onload = getUrlParameters;
    </script>
</body>
</html>
